# Windows / MacOS下虚拟机搭建


## 0x00 前言

### 什么是虚拟机

虚拟机，顾名思义就是虚拟出来的机器  ~~（废话）~~。当然这么说不太准确，因为并不是真正的虚拟出来一台新的电脑，确切一点应该是虚拟出来一个独立的操作系统。举个例子，一般情况下，购买的苹果电脑的用户只能使用MacOS，无法使用Windows，虚拟机的作用就是在你的Mac里生成一个应用程序，这个程序打开就是一个Windows系统，相当于把一个系统以软件的形式安装在你的电脑里，让你可以在一台电脑中同时使用两种系统，反之Windows用户可以通过虚拟机将MacOS安装在自己的电脑上。当然可以被虚拟出来的系统不仅限于MacOS和Windows，你可以通过虚拟机安装一切你知道的和你不知道的系统。

### 为什么需要虚拟机

我们的电脑在购买时，一般只会安装一个操作系统，最常见的就是  ~~巨硬~~  微软的Windows系统和苹果的MacOS系统，不会存在多个操作系统同时在的情况。而不同的操作系统又有不同的版本，Win系列常见的有WinXP、WinVista、Win7、Win8和Win10，MacOS从最初的8.5版本一路更新，到现在已经是10.15 Catalina了，一般情况下也不会存在多个版本同时存在的情况。

由于操作系统类型和版本在同一台机器上存在唯一性，所以当我们选择了其中一种系统类型和版本号时，我们就要放弃其他类型的系统和版本。举个例子，有些软件只支持到Win7系统，Win10用户自然无法使用，有些软件只开发了Windows版本，Mac用户自然也就体验不了。不过鲁迅先生也说过，小孩子才做选择，成年人全都要，虚拟机的存在就为我们完美的解决了这个问题，我们可以安装不同系统类型、不同系统版本的虚拟机，来使用这些不同系统、不同版本下的独占软件。

当然你也可以选择安装双系统，个人感觉不如虚拟机方面。

## 0x02 虚拟机经典用途

### 解决IE独占网站

我国一些机关政府类型的网站，几乎都是清一色**只适配的IE浏览器**，无论你使用主流的Safari、Chrome、Firefox、Edge，还是360、QQ、UC、遨游等浏览器，总有各种各样的问题在等着你。有的CSS样式出错，有的JS加载失败，有的甚至连网站直接卡死，七七八八的问题总有一款坑到你。然而IE这个食物链底层的浏览器，你在近几年的Windows系统里都找不着了，更不要说MacOS用户了，所以，我们需要一台安装了Win7的虚拟机来帮助我们正常的使用这些网站。

### 测试可疑文件

虚拟机内的任何操作都是和你的主机完全隔离的，所以哪怕你在虚拟机里面塞了999+的病毒也丝毫不会影响你主机的正常运行。我们可以利用这个特点，在虚拟机里面对一些可疑的文件进行测试，出了问题最差的情况不过就是把虚拟机删了重建，最大程度上避免了把自己主机搞崩溃需要重装系统的情况。

这里说一个最经典的案例，一些不擅长搜索的朋友们可能会经常碰到。当你需要下载一款破解版软件的时候，打开百度一搜，出来一排乱七八糟的下载站。你随便点一个网站进去，看到满屏的下载按钮不知所措，于是你随便点了一个，下载下来一个exe安装包，双击之后不仅没有获得你想要的破解软件，还擅自给你安装了一堆垃圾软件，将你的电脑瞬间卡死，从此开机之后弹窗不断永无宁日。有了虚拟机你就可以直接在虚拟机里面对这个安装包进行测试，万一中招了也不至于危机主机，一定程度上保证了你主机的安全。

### 使用某系统/版本独占软件

这个问题上面已经说过了，你可以安装不同的虚拟机来使用一些独占软件，免去了找朋友借电脑和自己花钱再买电脑的麻烦。特别值得说的就是可以玩一些小时候的经典游戏了，仙三外传问情篇他不香吗！

## 0x03 安装虚拟机软件

### MacOS用户

MacOS用户推荐安装Parallels Desktop，乔布斯钦点的虚拟机软件，用户体验好的一匹。国际惯例先进行安装包的下载，左转百度云：[点击传送](https://pan.baidu.com/s/18W-l8Dr8gBGmYDQKWmZfNw)，提取码：9497。土豪朋友请走官网通道，一年500~~也不贵嘛~~，支持正版的孩子都是值得尊敬的！[点击传送授权店](https://item.taobao.com/item.htm?id=536704674157)

这里以百度云下载的安装包为例，安装步骤如下，流程很简单不上图了：

+ 双击【Parallels_Desktop13.3.1.dmg】解压镜像文件
+ 双击【Parallels Desktop.dmg】图标，解压镜像文件
+ 双击【安装】图标
+ 提示【从互联网安装的应用，您确定要打开吗？】，点击【打开】
+ 点击【跳过该版本】
+ 点击【不，使用现有的】
+ 输入电脑密码，然后点击【好】
+ 安装完成

### Windows用户

Windows用户推荐安装VMware Workstation，个人目前正在使用，感觉良好。

Windows用户在安装软件之前，需要进入BIOS确认自己已经开启Hyper-V虚拟化服务。根据电脑品牌的不同，相应的操作流程和界面也不同。大家可以自行百度，关键词：XX电脑XX型号+BIOS+开启Hyper-V，多参考几篇就知道如何对应操作了。

开启Hyper-V后，国际惯例先进行安装包的下载，左转百度云：[点击传送](https://pan.baidu.com/s/16_JlJ31R6wR8ja_f7o9kNw)，提取码：4c94。土豪朋友请走官网通道，1709直接买断~~也不是很贵嘛~~，支持正版的孩子都是值得尊敬的！[点击传送官网](https://store.vmware.com/store?Action=DisplayProductDetailsPage&Env=BASE&Locale=zh_CN&SiteID=vmware&ThemeID=2485600&productID=5222154500&src=eBIZ_StoreHome_Featured_WorkstationPro_Buy_CN)

这里以百度云下载的安装包为例，安装步骤如下，流程很简单不上图了：

+ 鼠标右击【VMware 15.5.0】压缩包选择【解压到VMware 15.5.0】
+ 双击打开解压后的【VMware 15.5.0】文件夹
+ 鼠标右击【VMware 15.5.0】选择【以管理员身份运行】
+ 安装准备读条结束后，点击【下一步】
+ 勾选【我接受许可协议中的条款】，然后点击【下一步】
+ 点击【更改】更改软件的安装路径，建议安装在除C盘之外的其它磁盘，可以在D盘或者其它盘新建一个【VMware15】文件夹，然后点击【下一步】
+ 取消勾选【启动时检查产品更新...】与【加入VMware客户体验提升计划】，然后点击【下一步】
+ 狂点【下一步】，直至出现【安装】按钮，点击【安装】
+ 安装读条结束后，点击【许可证】
+ 许可证密钥输入【UY758-0RXEQ-M81WP-8ZM7Z-Y3HDA】，然后点击【输入】
+ 安装完成

## 0x04 下载系统镜像

虚拟机程序安装完毕之后，我们就要开始下载所需系统的镜像，这时候根据你需要安装的系统名称来选择，例如要安装Win7就需要下载Winodws 7的镜像文件。顺带一提，这个镜像和你平时重装电脑时用到的镜像是同一个东西。

### Winodws镜像下载

对于Windows系统镜像建议选择官方镜像，不要选择什么雨林木风、番茄花园等国内自制镜像，因为里面本身就会自带一堆的垃圾软件。这里推荐一个下载站（[点击传送](https://msdn.itellyou.cn/)），全是纯官方镜像，安全放心。进去后在左侧菜单选择操作系统，找到你需要的Windows系统版本，点击名称，便会在右侧出现对应的镜像下载地址。这里注意两点：

+ Windows系统是区分类型版本的，例如Win7就有家庭版、企业版、专业版、旗舰版等等等等....一般情况下，Win7我们选旗舰版（**Windows 7 Ultimate with Service Pack 1**），Win10我们选择个人版（**Windows 10 consumer editions**），其他的Win8、WinXP看需求，个人没有研究不做推荐

+ Windows系统也是区分CPU位数的，分别为x86和x64，也就是我们口中的32位和64位，一般情况下，有64位就选64位。如果你的主机还是32位的，emmmmm，你可以不用看下去了，先换台电脑吧

![](https://ptbuff-1301738307.cos.ap-guangzhou.myqcloud.com/2020-03-23-虚拟机-2.jpg)

### MacOS镜像下载

和Windows系统不同，MacOS的官方镜像是不能直接用于虚拟机安装的，需要自己转换成为ISO或者CDR格式，才能被VMware Workstation正确识别。个人目前没有发现什么比较好的MacOS镜像收录网站，所以这里就只提供一个**macOS Mojave 10.14.5**镜像文件的下载地址，提取码：yrxm。[点击传送](https://pan.baidu.com/s/1fpb_zon9bOU-1HgSJjeeQA)

## 0x05 创建虚拟机

准备好虚拟机软件和系统镜像文件之后，就可以开始进行虚拟机的创建了。

### 使用Parallels Desktop

Parallels Desktop创建虚拟机的步骤非常的友好，不愧是乔帮主钦点的产品，个人感觉不用看任何教程的情况下都可以顺利将虚拟机创建出来，不过这里提供一个视频教程，安装其他版本虚拟机的操作基本一致。

MacOS安装Win10虚拟机教学视频-bilibili。[点击传送](https://www.bilibili.com/video/BV1Zt41197FP?t=95)

至此你已经拥有了一个Win10的虚拟机，找个激活工具激活一下就可以正常使用了，不激活其实问题也不大。激活工具也给你准备好了，Win7和Win10都有，[点击传送百度云](https://pan.baidu.com/s/1yEV1dUHwUu25t3BTfH-mTQ)，提取码：k3ga。

### 使用VMware Workstation

由于已经有非常多关于安装各种虚拟机的帖子，这里就不亲自介绍了  ~~其实是懒得截图~~ ，给大家提供几个靠谱的链接。

创建MacOS虚拟机。[点击传送](https://blog.csdn.net/viafcccy/article/details/83053970)

创建Windows 7虚拟机。[点击传送](https://blog.csdn.net/weixin_43465312/article/details/92662519)

这里重点说一个处理器核数和内存分配的问题。这两个数值越大，你的虚拟机运行起来就越流畅，所以要根据个人需求和自身主机的情况的决定。一般来说，内存最低给2G，总核数最低给2核。

先说内存，假设你的主机内存有8G，日常工作中会稳定用掉3-4G的内存，那么你最多就只剩下4G的内存可以分配给你的虚拟机，同时要保证分配给虚拟机之后内存还有至少1G的容量来应对其他情况，那么你的最优分配方案就是给虚拟机2G。我个人使用的电脑有16G的内存，日常最多占用8G多，所以我可以给我的虚拟机分配4G内存，这样我还剩下将近4G内存来保证主机运行的流畅度。关于日常工作时的内存占用数值，我们可以通过任务管理器的性能面板查看，快捷键<kbd>Ctrl</kbd>+<kbd>shift</kbd>+<kbd>esc</kbd>。

再说核数。VM中总核数=处理器数量x每个处理器核心数量。关于这两项数据与主机CPU的核数、线程数的关系我至今也没有搞明白，不过通过日常使用得出一个准确的结论：处理器数量统一选1，每个处理器核心数量不要超过你主机CPU的最大线程数的一半。这样你的虚拟机既不会太卡，也不会占用太多的主机资源。关于如何查看主机CPU的最大线程数，在任务管理器的性能面板右下角，逻辑化处理那项数据就是最大线程数。

如果你还存在同时开多台虚拟机的需求，那就要保证所有虚拟机占用的线程数和内存加上主机日常使用的内存的总数不要超过你主机的内存和线程数的最大值，不然就没有办法同时打开多台虚拟机了。

## 0x06 虚拟机的入门操作

### 创建快照

虚拟机的快照功能，就相当一个备份，你可以随时将虚拟机还原到这个备份来，和当年还原精灵的功能差不多。有了快照功能，我们就可以非常放肆在虚拟机里面进行测试，搞砸了就恢复快照，将虚拟机重置为创建快照时候的样子。没错，这就是伊邪那岐！

一般建议创建两个快照，一份是虚拟机刚创建完毕时的快照，用于直接重置整个虚拟机，相当于快捷重装系统。另一份是要进行比较危险的操作前，创建一份快照，万一这次操作失败可以将虚拟机快速重置到操作之前。

Parallels Desktop的快照功能在顶部菜单的【操作】下拉栏内，VMware Workstation的快照功能在顶部菜单的【虚拟机】下拉栏内，具体如下图。

![](https://ptbuff-1301738307.cos.ap-guangzhou.myqcloud.com/2020-03-23-虚拟机-1.jpg)

### 创建共享文件夹

虚拟机的硬盘是从主机的硬盘上，单独占据一大块空间，供给虚拟机使用。就相当于在你自己的家里腾出部分的占地面积，建了一个四面包裹的十分严实的实验室，这个实验室就算里面核弹爆炸了，你家其他面积的部分也会不有任何损失。这样也有一个缺点，这个实验室需要一些东西的时候，没有办法主动从你家中获取，必须你手动送进去给它，反之你需要实验室里面一些东西的时候也只能亲自进去拿，有些时候这样子显得不太方便。于是你就在实验室边上又建了一个公共仓库，把实验室可能需要的东西都放进去，方便实验室需要时自行调配，实验室也会把你可能需要的东西放进仓库，方便你随时来取。这个仓库就是共享文件夹。

Parallels Desktop创建共享文件夹教程。[点击传送](http://download.parallels.com/desktop/v12/docs/zh_CN/Parallels%20Desktop%20User%27s%20Guide/32922.htm)

VMware Workstation创建共享文件夹教程。[点击传送](https://jingyan.baidu.com/article/200957610bc480cb0721b420.html)

## 0x07 总结

虚拟机的入门全过程归纳一下，就是分为四步：

+ 根据主机的系统选择虚拟机软件
+ 根据需要安装的虚拟机系统选择对应的镜像文件，进行下载
+ 打开虚拟机软件安装下载好的镜像文件
+ 配置初始化快照，按需设置共享文件夹

一般情况下，MacOS用户只有虚拟Windows系统的需求。一方面因为苹果一向严格要求软件适配系统，普通用户日常使用的软件都对最新版的MacOS有着良好的适配，所以也就大概率不会有在高版本MacOS下虚拟低版本MacOS的需求。另一方面，因为MacOS对Linux有着较好的兼容性，一般Linux的程序在MacOS下都可以正常运行，如果你还有虚拟Linux的需求，估计你已经去使用docker这类软件了。因此本文针对普通MacOS用户只提供了使用Parallels Desktop虚拟Windows的教程，如果你对其他操作系统有兴趣也可以自行搜索教程进行安装测试。关于Parallels Desktop的更多操作指南，可以参考这个B站UP主的视频，介绍的相对全面。[点击传送](https://space.bilibili.com/41062266/video?keyword=%E8%99%9A%E6%8B%9F%E6%9C%BA)

Windows算是兼容性最差的一个系统，因此虚拟各种其他系统的需求都会存在。本文列举最常见的虚拟低版本Windows和MacOS的情况，也足够普通用户的日常使用。这里特别说明一下，Windows虚拟MacOS的效果本身就不太好，有点卡顿是正常的，你主机配置差一点卡到爆炸也是正常的，毕竟白嫖要求也就不要太高了2333，能用上一些Mac独占的软件我已经很知足了。

都看到这里了，少年郎，不如试试？


